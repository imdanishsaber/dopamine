// src/contracts.js
import Web3 from 'web3';

const dopamineAbi = [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ReentrancyGuardReentrantCall","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"roundNumber","type":"uint256"},{"indexed":false,"internalType":"bool","name":"hasWinner","type":"bool"},{"indexed":false,"internalType":"address","name":"winner","type":"address"},{"indexed":false,"internalType":"uint256","name":"prizeAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"winningNumber","type":"uint256"}],"name":"MainLotteryResult","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"roundNumber","type":"uint256"}],"name":"MainLotteryRoundEndFailed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"roundNumber","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"startBlock","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"endBlock","type":"uint256"}],"name":"MainLotteryRoundStart","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"buyer","type":"address"},{"indexed":true,"internalType":"uint256","name":"roundNumber","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"ticketNumber","type":"uint256"}],"name":"MainTicketPurchased","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"roundNumber","type":"uint256"},{"indexed":false,"internalType":"address","name":"winner","type":"address"},{"indexed":false,"internalType":"uint256","name":"prizeAmount","type":"uint256"},{"indexed":false,"internalType":"uint8","name":"lotteryType","type":"uint8"}],"name":"SubLotteryResult","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"lotteryType","type":"uint8"},{"indexed":true,"internalType":"uint256","name":"roundNumber","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"startBlock","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"endBlock","type":"uint256"}],"name":"SubLotteryRoundStart","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"buyer","type":"address"},{"indexed":true,"internalType":"uint256","name":"roundNumber","type":"uint256"},{"indexed":false,"internalType":"uint8","name":"lotteryType","type":"uint8"},{"indexed":false,"internalType":"address","name":"referrer","type":"address"}],"name":"SubTicketPurchased","type":"event"},{"inputs":[],"name":"DOPAMINE_CONFIG","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"lotteryType","type":"uint8"},{"internalType":"string","name":"referrerUsername","type":"string"}],"name":"buySubLotteryTicket","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"config","outputs":[{"internalType":"contract IDopamineConfig","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"daiToken","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"emergencyResetMainLottery","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"lotteryType","type":"uint8"}],"name":"emergencyResetSubLottery","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getContractUSDCBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCurrentBlock","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCurrentMainLotteryInfo","outputs":[{"internalType":"uint256","name":"roundNumber","type":"uint256"},{"internalType":"uint256","name":"endBlock","type":"uint256"},{"internalType":"uint256","name":"ticketsSold","type":"uint256"},{"internalType":"uint256","name":"totalPrize","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"lotteryType","type":"uint8"}],"name":"getCurrentSubLotteryInfo","outputs":[{"internalType":"uint256","name":"roundNumber","type":"uint256"},{"internalType":"uint256","name":"endBlock","type":"uint256"},{"internalType":"uint256","name":"ticketPrice","type":"uint256"},{"internalType":"uint256","name":"usdcBalance","type":"uint256"},{"internalType":"uint256","name":"rewardBalance","type":"uint256"},{"internalType":"uint256","name":"participantCount","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMainLotteryPrize","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMainLotteryRemainingBlocks","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMainLotteryTicketsSold","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"lotteryType","type":"uint8"}],"name":"getSubLotteryCurrentRound","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"lotteryType","type":"uint8"}],"name":"getSubLotteryJackpot","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"lotteryType","type":"uint8"}],"name":"getSubLotteryParticipantCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"lotteryType","type":"uint8"}],"name":"getSubLotteryRemainingBlocks","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"lotteryType","type":"uint8"},{"internalType":"address","name":"participant","type":"address"}],"name":"hasParticipatedInSubLottery","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"mainLottery","outputs":[{"internalType":"uint256","name":"roundEndBlock","type":"uint256"},{"internalType":"uint256","name":"ticketCounter","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"mainLotteryCurrentRound","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"requireValidation","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bool","name":"_requireValidation","type":"bool"}],"name":"setRequireValidation","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"subLottery1","outputs":[{"internalType":"uint256","name":"ticketPrice","type":"uint256"},{"internalType":"uint256","name":"roundEndBlock","type":"uint256"},{"internalType":"uint256","name":"lastPurchaseBlock","type":"uint256"},{"internalType":"uint256","name":"usdcBalance","type":"uint256"},{"internalType":"uint256","name":"endRewardPercentage","type":"uint256"},{"internalType":"uint256","name":"rewardBalance","type":"uint256"},{"internalType":"uint256","name":"currentRound","type":"uint256"},{"internalType":"address","name":"firstParticipantReferrer","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"subLottery2","outputs":[{"internalType":"uint256","name":"ticketPrice","type":"uint256"},{"internalType":"uint256","name":"roundEndBlock","type":"uint256"},{"internalType":"uint256","name":"lastPurchaseBlock","type":"uint256"},{"internalType":"uint256","name":"usdcBalance","type":"uint256"},{"internalType":"uint256","name":"endRewardPercentage","type":"uint256"},{"internalType":"uint256","name":"rewardBalance","type":"uint256"},{"internalType":"uint256","name":"currentRound","type":"uint256"},{"internalType":"address","name":"firstParticipantReferrer","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"subLottery3","outputs":[{"internalType":"uint256","name":"ticketPrice","type":"uint256"},{"internalType":"uint256","name":"roundEndBlock","type":"uint256"},{"internalType":"uint256","name":"lastPurchaseBlock","type":"uint256"},{"internalType":"uint256","name":"usdcBalance","type":"uint256"},{"internalType":"uint256","name":"endRewardPercentage","type":"uint256"},{"internalType":"uint256","name":"rewardBalance","type":"uint256"},{"internalType":"uint256","name":"currentRound","type":"uint256"},{"internalType":"address","name":"firstParticipantReferrer","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"uniDaiEth","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"uniDaiUsdc","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"uniUsdcEth","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"usdcToken","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"wethToken","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"}];

const dopamineAddress = '0xf8Ab66725317612De240677f4914604e41b76737';

const getDopamineTokenUserSupply = async (web3, userAddress) => {
    const dopamineContract = new web3.eth.Contract(dopamineAbi, dopamineAddress);
    return await dopamineContract.methods.getDopamineTokenUserSupply(userAddress).call();
};

const getUSDCBalance = async (web3, userAddress) => {
    const dopamineContract = new web3.eth.Contract(dopamineAbi, dopamineAddress);
    return await dopamineContract.methods.getUSDCBalance(userAddress).call();
};

const getUserByWallet = async (web3, userAddress) => {
    const dopamineContract = new web3.eth.Contract(dopamineAbi, dopamineAddress);
    return await dopamineContract.methods.getUserByWallet(userAddress).call();
};

const registerReferral = async (web3, account, referralAddress) => {
    const dopamineContract = new web3.eth.Contract(dopamineAbi, dopamineAddress);
    return await dopamineContract.methods.registerReferral(referralAddress).send({ from: account });
};

const editWallet = async (web3, account, newWalletAddress) => {
    const dopamineContract = new web3.eth.Contract(dopamineAbi, dopamineAddress);
    return await dopamineContract.methods.editWallet(newWalletAddress).send({ from: account });
};

const getCurrentSubLotteryInfo = async (web3, userAddress) => {
    const dopamineContract = new web3.eth.Contract(dopamineAbi, dopamineAddress);
    return await dopamineContract.methods.getCurrentSubLotteryInfo(userAddress).call();
};

const buySubLotteryTicket = async (web3, account, ticketId) => {
    const dopamineContract = new web3.eth.Contract(dopamineAbi, dopamineAddress);
    return await dopamineContract.methods.buySubLotteryTicket(ticketId).send({ from: account });
};
const getCurrentMainLotteryInfo = async (web3) => {
    const dopamineContract = new web3.eth.Contract(dopamineAbi, dopamineAddress);
    return await dopamineContract.methods.getCurrentMainLotteryInfo().call();
};
export {
    getDopamineTokenUserSupply,
    getUSDCBalance,
    getUserByWallet,
    registerReferral,
    editWallet,
    getCurrentSubLotteryInfo,
    buySubLotteryTicket,
    getCurrentMainLotteryInfo
};
